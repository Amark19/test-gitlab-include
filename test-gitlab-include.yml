.set_config:
  script:
    - echo "Setting config vars..."
    - echo "BROWSERSTACK_USERNAME=${BROWSERSTACK_USERNAME}" > config.env
    - echo "BROWSERSTACK_ACCESS_KEY=${BROWSERSTACK_ACCESS_KEY}" >> config.env
    - echo "BROWSERSTACK_BUILD_NAME=AMAR-D-HERO" >> config.env
    - cat config.env
  artifacts:
    paths:
      - config.env

.report_plugin:
  image: alpine:latest
  script: |
    source config.env
    # Constants
    API_PATH="https://cad-report.vercel.app/api/v1/builds/buildReport"
    REPORT_STATUS_COMPLETED="COMPLETED"
    REPORT_STATUS_NOT_AVAILABLE="NOT_AVAILABLE"
    REPORT_STATUS_TEST_AVAILABLE="TEST_AVAILABLE"
    REPORT_STATUS_IN_PROGRESS="IN_PROGRESS"
    REQUESTING_CI="circle-ci"
    REPORT_FORMAT='["plainText", "richHtml"]'
  artifacts:
    paths:
      - browserstack-testreport.html
